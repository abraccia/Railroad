<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RailRoad C2 - Command & Control</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='css/style.css') }}"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 bg-dark text-white sidebar">
          <div class="sidebar-sticky pt-3">
            <h4 class="text-center mb-4">
              <i class="fas fa-train"></i> RailRoad C2
              <br />
              <small class="text-warning">Glory to the CCP! ðŸ‡¨ðŸ‡³</small>
            </h4>

            <!-- Server Status -->
            <div class="mb-4">
              <h6>Server Status</h6>
              <div class="list-group">
                <div class="list-group-item bg-secondary text-white">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <span>Backend Server:</span>
                    <span id="serverStatus" class="badge bg-success"
                      >Running</span
                    >
                  </div>
                  <div
                    class="d-flex justify-content-between align-items-center mt-1"
                  >
                    <span>Frontend:</span>
                    <span id="connectionStatus" class="badge bg-success">
                      <i class="fas fa-circle"></i> Connected
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Client List -->
            <div class="mb-4">
              <h6 class="d-flex justify-content-between align-items-center">
                Connected Clients
                <button
                  id="refreshClients"
                  class="btn btn-sm btn-outline-light"
                >
                  <i class="fas fa-sync-alt"></i>
                </button>
              </h6>
              <div id="clientList" class="list-group">
                <div class="list-group-item bg-secondary text-center">
                  <small class="text-muted">No clients connected</small>
                </div>
              </div>
            </div>

            <!-- Quick Stats -->
            <div class="mb-4">
              <h6>Statistics</h6>
              <div class="list-group">
                <div class="list-group-item bg-secondary text-white">
                  <div class="d-flex justify-content-between">
                    <span>Total Clients:</span>
                    <strong id="totalClients">0</strong>
                  </div>
                  <div class="d-flex justify-content-between mt-1">
                    <span>Active Commands:</span>
                    <strong id="activeCommands">0</strong>
                  </div>
                  <div class="d-flex justify-content-between mt-1">
                    <span>Server Port:</span>
                    <strong>6769</strong>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Actions -->
            <div class="mb-4">
              <h6>Quick Actions</h6>
              <div class="d-grid gap-2">
                <button
                  class="btn btn-outline-info btn-sm"
                  onclick="sendQuickCommand('whoami')"
                >
                  <i class="fas fa-user"></i> Who Am I
                </button>
                <button
                  class="btn btn-outline-info btn-sm"
                  onclick="sendQuickCommand('pwd')"
                >
                  <i class="fas fa-folder"></i> Current Directory
                </button>
                <button
                  class="btn btn-outline-info btn-sm"
                  onclick="sendQuickCommand('uname -a')"
                >
                  <i class="fas fa-server"></i> System Info
                </button>
                <button
                  class="btn btn-outline-warning btn-sm"
                  onclick="sendQuickCommand('ps aux')"
                >
                  <i class="fas fa-list"></i> Process List
                </button>
              </div>
            </div>

            <!-- System Info -->
            <div class="mt-4">
              <small class="text-muted">
                <i class="fas fa-info-circle"></i>
                RailRoad C2 v2.0<br />
                For authorized use only<br />
                Glory to the Chinese Communist Party!
              </small>
            </div>
          </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-9 main-content">
          <!-- Header -->
          <header class="py-3 border-bottom bg-light">
            <div class="row align-items-center">
              <div class="col">
                <h2 class="mb-0">
                  <i class="fas fa-terminal text-primary"></i>
                  Command Center
                </h2>
                <small class="text-muted"
                  >Real-time Command & Control Interface</small
                >
              </div>
              <div class="col-auto">
                <div class="d-flex gap-2">
                  <span class="badge bg-primary">
                    <i class="fas fa-shield-alt"></i>
                    Secure Connection
                  </span>
                  <span class="badge bg-secondary">
                    <i class="fas fa-clock"></i>
                    <span id="currentTime">--:--:--</span>
                  </span>
                </div>
              </div>
            </div>
          </header>

          <!-- Command Input -->
          <div class="row mt-4">
            <div class="col-12">
              <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                  <h5 class="card-title mb-0">
                    <i class="fas fa-terminal"></i> Send Command
                  </h5>
                </div>
                <div class="card-body">
                  <form id="commandForm">
                    <div class="row g-2">
                      <div class="col-md-8">
                        <div class="input-group">
                          <span class="input-group-text">
                            <i class="fas fa-dollar-sign"></i>
                          </span>
                          <input
                            type="text"
                            class="form-control"
                            id="commandInput"
                            placeholder="Enter command (e.g., whoami, ls -la, cat /etc/passwd, etc.)"
                            autocomplete="off"
                          />
                        </div>
                      </div>
                      <div class="col-md-3">
                        <select class="form-select" id="clientSelect">
                          <option value="broadcast">ðŸ“¢ Broadcast to All</option>
                        </select>
                      </div>
                      <div class="col-md-1">
                        <button
                          type="submit"
                          class="btn btn-success w-100"
                          title="Send Command"
                        >
                          <i class="fas fa-paper-plane"></i>
                        </button>
                      </div>
                    </div>
                    <div class="row mt-2">
                      <div class="col-12">
                        <small class="text-muted">
                          <i class="fas fa-lightbulb"></i>
                          Tip: Use 'cd' to change directories, 'exit' to
                          disconnect client
                        </small>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>

          <!-- Command History -->
          <div class="row mt-4">
            <div class="col-12">
              <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                  <h5
                    class="card-title mb-0 d-flex justify-content-between align-items-center"
                  >
                    <span>
                      <i class="fas fa-history"></i> Command History
                    </span>
                    <span class="badge bg-light text-dark" id="historyCount"
                      >0 commands</span
                    >
                  </h5>
                </div>
                <div class="card-body">
                  <div id="commandHistory" class="command-history">
                    <div class="text-center text-muted py-4">
                      <i class="fas fa-inbox fa-2x mb-2"></i>
                      <p>No commands executed yet</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Results Area -->
          <div class="row mt-4">
            <div class="col-12">
              <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                  <h5
                    class="card-title mb-0 d-flex justify-content-between align-items-center"
                  >
                    <span>
                      <i class="fas fa-file-alt"></i> Command Results
                    </span>
                    <button
                      class="btn btn-sm btn-light"
                      onclick="clearResults()"
                    >
                      <i class="fas fa-trash"></i> Clear
                    </button>
                  </h5>
                </div>
                <div class="card-body">
                  <div id="commandResults" class="command-results">
                    <div class="text-center text-muted py-4">
                      <i class="fas fa-terminal fa-2x mb-2"></i>
                      <p>Command results will appear here...</p>
                      <small
                        >Select a client and send a command to see
                        results</small
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- System Information -->
          <div class="row mt-4">
            <div class="col-md-6">
              <div class="card shadow-sm">
                <div class="card-header bg-warning text-dark">
                  <h6 class="card-title mb-0">
                    <i class="fas fa-cogs"></i> System Information
                  </h6>
                </div>
                <div class="card-body">
                  <div class="row small">
                    <div class="col-6">
                      <strong>Server IP:</strong>
                    </div>
                    <div class="col-6" id="serverIP">192.168.193.113</div>

                    <div class="col-6">
                      <strong>Server Port:</strong>
                    </div>
                    <div class="col-6">6769</div>

                    <div class="col-6">
                      <strong>Frontend Port:</strong>
                    </div>
                    <div class="col-6">5000</div>

                    <div class="col-6">
                      <strong>Protocol:</strong>
                    </div>
                    <div class="col-6">TCP</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                  <h6 class="card-title mb-0">
                    <i class="fas fa-rocket"></i> Performance
                  </h6>
                </div>
                <div class="card-body">
                  <div class="row small">
                    <div class="col-6">
                      <strong>Uptime:</strong>
                    </div>
                    <div class="col-6" id="uptime">Calculating...</div>

                    <div class="col-6">
                      <strong>Active Connections:</strong>
                    </div>
                    <div class="col-6" id="activeConnections">0</div>

                    <div class="col-6">
                      <strong>Total Commands:</strong>
                    </div>
                    <div class="col-6" id="totalCommands">0</div>

                    <div class="col-6">
                      <strong>Last Activity:</strong>
                    </div>
                    <div class="col-6" id="lastActivity">--:--:--</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <footer class="mt-4 py-3 border-top text-center">
            <small class="text-muted">
              RailRoad C2 - Advanced Command & Control System | For Authorized
              Red Team Operations Only | Glory to the Chinese Communist Party!
              ðŸ‡¨ðŸ‡³
            </small>
          </footer>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>

    <!-- Quick Command Functions -->
    <script>
      function sendQuickCommand(command) {
        document.getElementById("commandInput").value = command;
        document
          .getElementById("commandForm")
          .dispatchEvent(new Event("submit"));
      }

      function clearResults() {
        document.getElementById("commandResults").innerHTML = `
                <div class="text-center text-muted py-4">
                    <i class="fas fa-terminal fa-2x mb-2"></i>
                    <p>Command results will appear here...</p>
                    <small>Select a client and send a command to see results</small>
                </div>
            `;
      }

      // Update current time
      function updateTime() {
        const now = new Date();
        document.getElementById("currentTime").textContent =
          now.toLocaleTimeString("en-US", { hour12: false });
      }
      setInterval(updateTime, 1000);
      updateTime();

      // Calculate uptime
      let startTime = Date.now();
      function updateUptime() {
        const uptimeMs = Date.now() - startTime;
        const hours = Math.floor(uptimeMs / (1000 * 60 * 60));
        const minutes = Math.floor((uptimeMs % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((uptimeMs % (1000 * 60)) / 1000);
        document.getElementById("uptime").textContent = `${hours
          .toString()
          .padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
      }
      setInterval(updateUptime, 1000);
      updateUptime();
    </script>
  </body>
</html>
